(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    129747,       3133]
NotebookOptionsPosition[    129007,       3112]
NotebookOutlinePosition[    129589,       3133]
CellTagsIndexPosition[    129546,       3130]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"grafobase", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"2", ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"3", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "   ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Punto", " ", "di", " ", "partenza", " ", "dal", " ", "quale"}], 
    ",", " ", "costruttivamente", ",", " ", 
    RowBox[{
    "si", " ", "assemblano", " ", "tutti", " ", "i", " ", "possibili", " ", 
     "n", " ", "grafi"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"generagrafi", "[", "n_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "temp", "}"}], ",", " ", 
      RowBox[{"(*", 
       RowBox[{
       "Restituisce", " ", "la", " ", "lista", " ", "di", " ", "tutti", " ", 
        "i", " ", "possibili", " ", "grafi", " ", "con", " ", "n", " ", 
        "linee", " ", "esterne"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"i", "=", "3"}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"listagrafi", "=", 
        RowBox[{"{", "grafobase", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"i", "<", "n"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"nuovigrafi3", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{"inserzione3", ",", "listagrafi"}], "]"}], ",", "1"}], 
            "]"}]}], ";", "  ", 
          RowBox[{"(*", 
           RowBox[{
           "Ad", " ", "ogni", " ", "grafo", " ", "in", " ", "listagrafi", " ",
             "fai", " ", "tutte", " ", "le", " ", "possibili", " ", 
            "inserzioni", " ", "a", " ", "3"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"nuovigrafi4", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{"inserzione4", ",", "listagrafi"}], "]"}], ",", "1"}], 
            "]"}]}], ";", "  ", 
          RowBox[{"(*", 
           RowBox[{
           "Ad", " ", "ogni", " ", "grafo", " ", "in", " ", "listagrafi", " ",
             "fai", " ", "tutte", " ", "le", " ", "possibili", " ", 
            "inserzioni", " ", "a", " ", "4"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"listagrafi", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"nuovigrafi3", ",", "nuovigrafi4"}], "]"}]}], ";", 
          "                           ", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "Rimpiazza", " ", "listagrafi", " ", "con", " ", "i", " ", 
             "nuovi", " ", "grafi"}], ",", " ", 
            RowBox[{
             RowBox[{"che", " ", "avranno", " ", "n"}], "+", 
             RowBox[{"1", " ", "linee", " ", "esterne"}]}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"++", "i"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
       "listagrafi"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Sostituisce", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "2"}]}], "}"}], " ", "con", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "nuovovertice"}], "}"}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "2"}], ",", "nuovovertice"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"nuovopuntoesterno", ",", " ", "nuovovertice"}], "}"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"inserisci3", "[", 
     RowBox[{"pos_", ",", "ext_", ",", "int_", ",", "grafo_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"ReplacePart", "[", 
      RowBox[{"grafo", ",", 
       RowBox[{"pippo", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ext", ",", "int"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"grafo", "[", 
            RowBox[{"[", 
             RowBox[{"pos", ",", "1"}], "]"}], "]"}], ",", "int"}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"grafo", "[", 
            RowBox[{"[", 
             RowBox[{"pos", ",", "2"}], "]"}], "]"}], ",", "int"}], "}"}]}], 
        "]"}], ",", "pos"}], "]"}], "/.", 
     RowBox[{"pippo", "\[Rule]", "Sequence"}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"inserzione3", "[", "grafo_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "temp", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"indici", "=", 
        RowBox[{"Flatten", "[", "grafo", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"npt", "=", 
        RowBox[{"Max", "[", "indici", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nvert", "=", 
        RowBox[{"Min", "[", "indici", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nuovigrafi", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"inserisci3", "[", 
           RowBox[{"i", ",", 
            RowBox[{"npt", "+", "1"}], ",", 
            RowBox[{"nvert", "-", "1"}], ",", "grafo"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "grafo", "]"}]}], "}"}]}], "]"}]}]}]}], 
     "]"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{
   "Su", " ", "tutte", " ", "le", " ", "linee", " ", "del", " ", "grafo", " ",
     "applica", " ", "inserisci3"}], "*)"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"inserzione4", "[", "grafo_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "temp", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"indici", "=", 
        RowBox[{"Flatten", "[", "grafo", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"npt", "=", 
        RowBox[{"Max", "[", "indici", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nvert", "=", 
        RowBox[{"Min", "[", "indici", "]"}]}], ";", " ", 
       "\[IndentingNewLine]", 
       RowBox[{"nuovigrafi", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"inserisci4", "[", 
           RowBox[{"i", ",", 
            RowBox[{"npt", "+", "1"}], ",", "grafo"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"-", "1"}], ",", "nvert", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"nuovigrafi", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"nuovigrafi", ",", 
          RowBox[{"{", "}"}]}], "]"}]}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"inserisci4", "[", 
     RowBox[{"vertice_", ",", "ext_", ",", "grafo_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Count", "[", 
        RowBox[{"grafo", ",", "vertice", ",", "2"}], "]"}], "===", "3"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"Append", "[", 
       RowBox[{"grafo", ",", 
        RowBox[{"{", 
         RowBox[{"ext", ",", "vertice"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"(*", 
       RowBox[{"Sempicemente", " ", "aggiungi", " ", "al", " ", "grafo", " ", 
        RowBox[{"{", 
         RowBox[{"nuovopuntoesterno", ",", " ", "nuovovertice"}], "}"}]}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"listaimpulsi", "[", "grafo_", "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"p", ",", "#"}], "]"}], "&"}], ",", "grafo"}], "]"}]}], ";"}],
   "                                               ", 
  RowBox[{"(*", 
   RowBox[{"Trasforma", " ", "i", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], " ", "in", " ", 
    RowBox[{"p", "[", 
     RowBox[{"1", ",", "2"}], "]"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"generaequazioni", "[", "grafo_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "temp", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"indici", "=", 
        RowBox[{"Flatten", "[", "grafo", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"npt", "=", 
        RowBox[{"Max", "[", "indici", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nvert", "=", 
        RowBox[{"Min", "[", "indici", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"impulsi", "=", 
        RowBox[{"listaimpulsi", "[", "grafo", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"equazioni", "=", 
        RowBox[{
        "Table", "[", 
         "                                                                    \
   ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Si", " ", "cicla", " ", "su", " ", "ogni", " ", "vertice"}], ",", 
           " ", 
           RowBox[{
           "di", " ", "modo", " ", "da", " ", "otterne", " ", "una", " ", 
            "lista", " ", "di", " ", "leggi", " ", "di", " ", 
            "conservazione"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"impulsivertice", "=", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"impulsi", ",", 
                RowBox[{"p", "[", 
                 RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
              RowBox[{"-", 
               RowBox[{"Cases", "[", 
                RowBox[{"impulsi", ",", 
                 RowBox[{"p", "[", 
                  RowBox[{"i", ",", "_"}], "]"}]}], "]"}]}]}], "]"}]}], ";", 
           " ", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "Per", " ", "ogni", " ", "vertice", " ", "si", " ", "prendono", 
              " ", "gli", " ", "impulsi", " ", "corrispondenti"}], ",", " ", 
             RowBox[{
             "che", " ", "siano", " ", "a", " ", "sinistra", " ", "o", " ", 
              "a", " ", "destra"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"Plus", ",", "impulsivertice"}], "]"}], "\[Equal]", 
            "0"}]}], ",", 
          "                                                                   \
                           ", 
          RowBox[{"(*", 
           RowBox[{
           "Somma", " ", "gli", " ", "impulsi", " ", "di", " ", "tale", " ", 
            "lista", " ", "cambiando", " ", "head"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"-", "1"}], ",", "nvert", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], 
         "                                                                    \
   ", 
         RowBox[{"(*", 
          RowBox[{
          "modo", " ", "per", " ", "ciclare", " ", "su", " ", "tutti", " ", 
           "i", " ", "vertici"}], "*)"}], "\[IndentingNewLine]", "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"equazioni", "=", 
        RowBox[{"equazioni", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"p", "[", 
            RowBox[{
             RowBox[{"k_", "/;", 
              RowBox[{"k", ">", "0"}]}], ",", "t_"}], "]"}], "\[Rule]", 
           RowBox[{"p", "[", "k", "]"}]}], "}"}]}]}], ";", "     ", 
       RowBox[{"(*", 
        RowBox[{
        "Applico", " ", "regola", " ", "di", " ", "sostituzione", " ", "agli",
          " ", "impulsi", " ", "delle", " ", "linee", " ", "entranti"}], 
        "*)"}], "\n", "       ", 
       RowBox[{"incognite", "=", 
        RowBox[{"Cases", "[", 
         RowBox[{"equazioni", ",", 
          RowBox[{"p", "[", ",", "]"}], ",", "Infinity"}], "]"}]}], ";", 
       "              ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Ora", " ", "le", " ", "incognite", " ", "sono", " ", "tutti", " ", 
          "i", " ", "momenti", " ", "che", " ", "hanno", " ", "due", " ", 
          "indici"}], ",", " ", 
         RowBox[{"ossia", " ", "quelli", " ", "interni"}]}], "*)"}], "  ", 
       "\n", "       ", 
       RowBox[{"globale", "=", 
        RowBox[{"Rule", "[", 
         RowBox[{
          RowBox[{"p", "[", "npt", "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"p", "[", "l", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", 
               RowBox[{"npt", "-", "1"}]}], "}"}]}], "]"}]}]}], "]"}]}], ";", 
       "  ", 
       RowBox[{"(*", 
        RowBox[{
        "Si", " ", "definisce", " ", "la", " ", "regola", " ", "di", " ", 
         "sostituzione", " ", "per", " ", "eliminare", " ", "uno", " ", "dei",
          " ", "momenti", " ", "esterni", " ", "in", " ", "favore", " ", 
         "deglialtri", " ", "sfruttando", " ", "la", " ", "conservazione", 
         " ", "globale"}], "*)"}], "\n", "       ", 
       RowBox[{"equazioni", "=", 
        RowBox[{"equazioni", "/.", "globale"}]}], ";", "\n", "      ", 
       RowBox[{"impulsiinterni", "=", 
        RowBox[{"Solve", "[", 
         RowBox[{"equazioni", ",", "incognite"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "impulsiinterni"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"generaequazioniCariche", "[", "diagramma_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "temp", "}"}], ",", "   ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"grafo", "=", 
        RowBox[{"diagramma", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"entranti", "=", 
        RowBox[{"diagramma", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"carichedate", "=", 
        RowBox[{"diagramma", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", 
       "                                                                      \
                           ", "\[IndentingNewLine]", 
       RowBox[{"indici", "=", 
        RowBox[{"Flatten", "[", "grafo", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"npt", "=", 
        RowBox[{"Max", "[", "indici", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nvert", "=", 
        RowBox[{"Min", "[", "indici", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cariche", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Apply", "[", 
            RowBox[{"q", ",", "#"}], "]"}], "&"}], ",", "grafo"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"equazioni", "=", 
        RowBox[{
        "Table", "[", 
         "                                                                    \
   ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Si", " ", "cicla", " ", "su", " ", "ogni", " ", "vertice"}], ",", 
           " ", 
           RowBox[{
           "di", " ", "modo", " ", "da", " ", "otterne", " ", "una", " ", 
            "lista", " ", "di", " ", "leggi", " ", "di", " ", 
            "conservazione"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"carichevertice", "=", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"cariche", ",", 
                RowBox[{"q", "[", 
                 RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
              RowBox[{"-", 
               RowBox[{"Cases", "[", 
                RowBox[{"cariche", ",", 
                 RowBox[{"q", "[", 
                  RowBox[{"i", ",", "_"}], "]"}]}], "]"}]}]}], "]"}]}], ";", 
           " ", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "Per", " ", "ogni", " ", "vertice", " ", "si", " ", "prendono", 
              " ", "le", " ", "cariche", " ", "corrispondenti"}], ",", " ", 
             RowBox[{
             "che", " ", "siano", " ", "a", " ", "sinistra", " ", "o", " ", 
              "a", " ", "destra"}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"Plus", ",", "carichevertice"}], "]"}], "\[Equal]", 
            "0"}]}], ",", 
          "                                                                   \
                           ", 
          RowBox[{"(*", 
           RowBox[{
           "Somma", " ", "le", " ", "cariche", " ", "di", " ", "tale", " ", 
            "lista", " ", "cambiando", " ", "head"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"-", "1"}], ",", "nvert", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"datiEntranti", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Rule", "[", 
           RowBox[{
            RowBox[{"q", "[", 
             RowBox[{"i", ",", "_"}], "]"}], ",", 
            RowBox[{"carichedate", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "entranti"}], "}"}]}], "]"}]}], ";", 
       "        ", 
       RowBox[{"(*", 
        RowBox[{
        "Le", " ", "cariche", " ", "di", " ", "gambe", " ", "entranti", " ", 
         "sono", " ", "sostituite", " ", "con", " ", "il", " ", "loro", " ", 
         "valore"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"datiUscenti", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Rule", "[", 
           RowBox[{
            RowBox[{"q", "[", 
             RowBox[{"i", ",", "_"}], "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"carichedate", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], " ", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"entranti", "+", "1"}], ",", "npt"}], "}"}]}], "]"}]}], 
       ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "Le", " ", "cariche", " ", "di", " ", "gambe", " ", "uscenti", " ", 
         "sono", " ", "sostituite", " ", "con", " ", "il", " ", "loro", " ", 
         "valore", " ", "cambiato", " ", "di", " ", "segno"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"dati", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"datiEntranti", ",", "datiUscenti"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"equazioni", "=", 
        RowBox[{"equazioni", "/.", " ", "dati"}]}], ";", "      ", 
       RowBox[{"(*", 
        RowBox[{
        "Applico", " ", "regola", " ", "di", " ", "sostituzione", " ", "a", 
         " ", "tali", " ", "cariche"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"incognite", "=", 
        RowBox[{"Cases", "[", 
         RowBox[{"equazioni", ",", 
          RowBox[{"q", "[", ",", "]"}], ",", "Infinity"}], "]"}]}], ";", 
       "             ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Ora", " ", "le", " ", "incognite", " ", "sono", " ", "tutte", " ", 
          "le", " ", "cariche", " ", "che", " ", "hanno", " ", "due", " ", 
          "indici"}], ",", " ", 
         RowBox[{"ossia", " ", "quelle", " ", "interne"}]}], "*)"}], " ", 
       "\n", "      ", 
       RowBox[{"caricheinterne", "=", 
        RowBox[{"Solve", "[", 
         RowBox[{"equazioni", ",", "incognite"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "caricheinterne"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"VISUALIZZAZIONE", " ", "DEI", " ", "GRAFI"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"grafaungrafo", "[", "grafo_", "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"TwoWayRule", ",", "#"}], "]"}], "&"}], ",", "grafo"}], 
     "]"}]}], ";"}], "   ", 
  RowBox[{"(*", 
   RowBox[{
   "A", " ", "ciascuna", " ", "linea", " ", "del", " ", "grafo", " ", "si", 
    " ", "applica", " ", "il", " ", "cambiamento", " ", "della", " ", "Head", 
    " ", "in", " ", "TwoWayRule"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Applica", " ", "la", " ", "funzione", " ", "Graph", " ", "che", " ", 
    "disegna", " ", "a", " ", "tutti", " ", "gli", " ", "elementi", " ", 
    "della", " ", "lista", "\[IndentingNewLine]", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Graph", "[", 
        RowBox[{"#", ",", 
         RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}]}], "]"}], "&"}], 
      ",", 
      RowBox[{"GraficaGrafi", "[", "5", "]"}]}], "]"}]}], "  ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Funzioni", " ", "formali", " ", "per", " ", "vertici"}], ",", 
    " ", 
    RowBox[{"propagatori", " ", "e", " ", "linee", " ", "esterne"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"V", "[", 
      RowBox[{"i_", ",", "j_", ",", "k_"}], "]"}], "[", "n_", "]"}], ":=", 
    RowBox[{"V2", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"i", ",", "n"}], "]"}], ",", 
        RowBox[{"p", "[", 
         RowBox[{"j", ",", "n"}], "]"}], ",", 
        RowBox[{"p", "[", 
         RowBox[{"k", ",", "n"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"q", "[", 
         RowBox[{"i", ",", "n"}], "]"}], ",", 
        RowBox[{"q", "[", 
         RowBox[{"j", ",", "n"}], "]"}], ",", 
        RowBox[{"q", "[", 
         RowBox[{"k", ",", "n"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "i", "}"}], ",", 
        RowBox[{"{", "j", "}"}], ",", 
        RowBox[{"{", "k", "}"}]}], "}"}]}], " ", "]"}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"V", "[", 
     RowBox[{"i_", ",", "j_", ",", "k_", ",", "l_"}], "]"}], "[", "n_", "]"}],
    ":=", 
   RowBox[{"V2", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p", "[", 
        RowBox[{"i", ",", "n"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"j", ",", "n"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"k", ",", "n"}], "]"}], ",", 
       RowBox[{"p", "[", 
        RowBox[{"l", ",", "n"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"q", "[", 
        RowBox[{"i", ",", "n"}], "]"}], ",", 
       RowBox[{"q", "[", 
        RowBox[{"j", ",", "n"}], "]"}], ",", 
       RowBox[{"q", "[", 
        RowBox[{"k", ",", "n"}], "]"}], ",", 
       RowBox[{"q", "[", 
        RowBox[{"l", ",", "n"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "i", "}"}], ",", 
       RowBox[{"{", "j", "}"}], ",", 
       RowBox[{"{", "k", "}"}], ",", 
       RowBox[{"{", "l", "}"}]}], " ", "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prop", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"Prop2", "[", 
    RowBox[{
     RowBox[{"p", "[", 
      RowBox[{"a", ",", "b"}], "]"}], ",", 
     RowBox[{"q", "[", 
      RowBox[{"a", ",", "b"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "a", "}"}], ",", 
       RowBox[{"{", "b", "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Est", "[", "i_", "]"}], ":=", 
   RowBox[{"Est2", "[", 
    RowBox[{
     RowBox[{"p", "[", "i", "]"}], ",", 
     RowBox[{"q", "[", "i", "]"}], ",", 
     RowBox[{"{", "i", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Generazione", " ", "delle", " ", "liste", " ", "di", " ", "linee", " ", 
     "esterne"}], ",", " ", 
    RowBox[{"interne", " ", "e", " ", "vertici"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"listalineeesterne", "[", "grafo_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Est", "[", "i", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Max", "[", 
         RowBox[{"Flatten", "[", "grafo", "]"}], "]"}]}], "}"}]}], "]"}]}], 
   ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"Lista", " ", "di", " ", 
    RowBox[{"Est", "[", "i", "]"}], " ", "con", " ", "i", " ", "intero", " ", 
    "positivo"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"listapropagatori", "[", "grafo_", "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Apply", "[", 
        RowBox[{"Prop", ",", "#"}], "]"}], "&"}], ",", 
      RowBox[{"Cases", "[", 
       RowBox[{"grafo", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"i_", "/;", 
           RowBox[{"i", "<", "0"}]}], ",", 
          RowBox[{"j_", "/;", 
           RowBox[{"j", "<", "0"}]}]}], "}"}]}], "]"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Restitutisce", " ", 
     RowBox[{"Prop", "[", 
      RowBox[{
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "2"}]}], "]"}], " ", "etc"}], "..."}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"listavertici", "[", "grafo_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "temp", "}"}], ",", "  ", 
     RowBox[{"(*", 
      RowBox[{"Restituisce", " ", "lista", " ", 
       RowBox[{
        RowBox[{"V", "[", 
         RowBox[{"1", ",", "2", ",", 
          RowBox[{"-", "2"}]}], "]"}], "[", 
        RowBox[{"-", "1"}], "]"}], " ", "et", " ", "cetera", " ", "per", " ", 
       "tutti", " ", "i", " ", "vertici", " ", "del", " ", "grafo"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"indici", "=", 
       RowBox[{"Flatten", "[", "grafo", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"npt", "=", 
       RowBox[{"Max", "[", "indici", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nvert", "=", 
       RowBox[{"Min", "[", "indici", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "risultato", " ", "fa", " ", "una", " ", "Table", " ", "ciclando", 
         " ", "su", " ", "ogni", " ", "vertici"}], ",", " ", 
        RowBox[{"di", " ", "elementi", " ", "del", " ", "tipo", " ", 
         RowBox[{
          RowBox[{"V", "[", "]"}], "[", "i", "]"}]}], ",", " ", 
        RowBox[{
        "con", " ", "i", " ", "numero", " ", "vertice", " ", "e", " ", "il", 
         " ", "contenuto", " ", "di", " ", "V", " ", "\[EGrave]", " ", 
         "ottenuto", " ", "con", " ", "dei", " ", "Cases", " ", "che", " ", 
         "restituiscono", " ", "gli", " ", "a", " ", "b", " ", "in", " ", 
         RowBox[{"{", 
          RowBox[{"a", ",", "i"}], "}"}], " ", "o", " ", 
         RowBox[{"{", 
          RowBox[{"i", ",", "b"}], "}"}], " ", "cercando", " ", "nel", " ", 
         "grafo"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"risultato", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Apply", "[", 
           RowBox[{"V", ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"grafo", ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"i", ",", "j_"}], "}"}], "->", "j"}]}], "]"}], ",", 
              RowBox[{"Cases", "[", 
               RowBox[{"grafo", ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"k_", ",", "i"}], "}"}], "->", "k"}]}], "]"}]}], 
             "]"}]}], "]"}], "[", "i", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"-", "1"}], ",", "nvert", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]",
       "risultato"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"diagramma", "[", 
     RowBox[{"grafo_", ",", "entranti_", ",", "x_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"grafo", ",", "entranti", ",", "x"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Oggetto", " ", "che", " ", "sinteticamente", " ", "in", " ", "s\[EAcute]",
     " ", "raguna", " ", "tutte", " ", "le", " ", "informazioni", " ", 
    "necessarie"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "LE", " ", "LISTE", " ", "DI", " ", "VERTICI", " ", "E", " ", 
    "PROPAGATORI", " ", "DIVENGONO", " ", "ARGOMENTI", " ", "PER", " ", 
    "DELLE", " ", "FUNZIONI", " ", "CON", " ", "ESPRESSIONI", " ", 
    "MATEMATICHE"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Est3", "[", 
    RowBox[{"a_", ",", "0", ",", 
     RowBox[{"{", "c_", "}"}]}], "]"}], ":=", 
   RowBox[{"SP", "[", 
    RowBox[{
     RowBox[{"Epsilon", "[", "a", "]"}], ",", 
     RowBox[{"{", "c", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Est3", "[", 
    RowBox[{"a_", ",", "b_", ",", 
     RowBox[{"{", "c_", "}"}]}], "]"}], ":=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V3", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_", ",", "c_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d_", ",", "e_", ",", "f_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"g_", ",", "h_", ",", "i_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "temp", "}"}], ",", "    ", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "vertici", " ", "a", " ", "tre", " ", "in", " ", "qed", " ", 
        "scalare"}], ",", " ", 
       RowBox[{
       "sono", " ", "necessari", " ", "solo", " ", "due", " ", "addendi"}], 
       ",", " ", 
       RowBox[{"ma", " ", "uno", " ", "e`", " ", "zero", " ", "sempre"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"listamomenti", "=", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"listacariche", "=", 
       RowBox[{"{", 
        RowBox[{"d", ",", "e", ",", "f"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"listaindici", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "g", "}"}], ",", 
         RowBox[{"{", "h", "}"}], ",", 
         RowBox[{"{", "i", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"indice", "=", 
       RowBox[{"listaindici", "[", 
        RowBox[{"[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"listacariche", ",", "0"}], "]"}], "]"}], "]"}], "]"}]}], 
      ";", " ", 
      RowBox[{"(*", 
       RowBox[{
       "Devo", " ", "sapere", " ", "quale", " ", "indice", " ", "di", " ", 
        "Lorentz", " ", 
        RowBox[{"prendere", ".", " ", "Ne"}], " ", "prelevo", " ", "la", " ", 
        "posizione", " ", "in", " ", "listaindici", " ", "cercando", " ", 
        "la", " ", "posizione", " ", "del", " ", "fotone", " ", "nella", " ", 
        "listacariche"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"risultato", "=", 
       RowBox[{"I", "*", "Qel", "*", 
        RowBox[{"SP", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "*", "d"}], "+", 
           RowBox[{"b", "*", "e"}], "+", 
           RowBox[{"f", "*", "c"}]}], ",", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Flatten", "[", "indice", "]"}], "]"}]}], "]"}]}]}], ";", 
      " ", 
      RowBox[{"(*", 
       RowBox[{
       "NON", " ", "FUNZIONA", " ", "SE", " ", "NON", " ", "CI", " ", "SONO", 
        " ", "INDICI", " ", "DI", " ", "LORENTZ", " ", "E", " ", 
        RowBox[{"C", "'"}], "E`", " ", "SOLO", " ", "UNA", " ", "CARICA", " ",
         "ENTRANTE"}], "*)"}], "\[IndentingNewLine]", "risultato"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V3", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_", ",", "c_", ",", "z_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"d_", ",", "e_", ",", "f_", ",", "i_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"g_", ",", "h_", ",", "j_", ",", "k_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "temp", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"listacariche", "=", 
       RowBox[{"{", 
        RowBox[{"d", ",", "e", ",", "f", ",", "i"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"listaindici", "=", 
       RowBox[{"{", 
        RowBox[{"g", ",", "h", ",", "j", ",", "k"}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"indici", "=", 
       RowBox[{"listaindici", "[", 
        RowBox[{"[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"listacariche", ",", "0"}], "]"}], "]"}], "]"}], "]"}]}], 
      ";", " ", 
      RowBox[{"(*", 
       RowBox[{
       "Analogo", " ", "a", " ", "prima", " ", "ma", " ", "adesso", " ", 
        "sono", " ", "due"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"risultato", "=", 
       RowBox[{"2", "*", "I", "*", "Qel", "*", "Qel", "*", 
        RowBox[{"SP", "[", 
         RowBox[{
          RowBox[{"indici", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"indici", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", "risultato"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Prop3", "[", 
    RowBox[{"a_", ",", "e_", ",", 
     RowBox[{"{", 
      RowBox[{"b_", ",", "c_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"I", "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"SP", "[", 
       RowBox[{"a", ",", "a"}], "]"}], "-", 
      RowBox[{"Mel", "^", "2"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Prop3", "[", 
     RowBox[{"a_", ",", "0", ",", 
      RowBox[{"{", 
       RowBox[{"b_", ",", "c_"}], "}"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"-", "I"}], "*", 
     RowBox[{
      RowBox[{"SP", "[", 
       RowBox[{"b", ",", "c"}], "]"}], "/", 
      RowBox[{"SP", "[", 
       RowBox[{"a", ",", "a"}], "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"grafiammessi", "=", 
    RowBox[{"{", "}"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "Lista", " ", "ove", " ", "si", " ", "albergano", " ", "tutti", " ", "i", 
    " ", "grafi", " ", "che", " ", "contribuiscono", " ", 
    RowBox[{"all", "'"}], "ampiezza"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"generaampiezza", "[", "diagramma_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "temp", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"grafo", "=", 
        RowBox[{"diagramma", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"entranti", "=", 
        RowBox[{"diagramma", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"carichedate", "=", 
        RowBox[{"diagramma", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
       RowBox[{"indici", "=", 
        RowBox[{"Flatten", "[", "grafo", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"npt", "=", 
        RowBox[{"Max", "[", "indici", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"nvert", "=", 
        RowBox[{"Min", "[", "indici", "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"LLE", "=", 
        RowBox[{"listalineeesterne", "[", "grafo", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"LP", "=", 
        RowBox[{"listapropagatori", "[", "grafo", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"LV", "=", 
        RowBox[{"listavertici", "[", "grafo", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"A0", " ", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"LLE", ",", "LP", ",", "LV"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"sostituzioniCariche", " ", "=", " ", 
        RowBox[{"generaequazioniCariche", "[", "diagramma", "]"}]}], ";", 
       "   ", 
       RowBox[{"(*", 
        RowBox[{"Equazione", " ", "delle", " ", "cariche"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"CONSISTENZA", " ", "CARICHE"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Acc", "=", 
        RowBox[{"Cases", "[", " ", 
         RowBox[{"sostituzioniCariche", ",", 
          RowBox[{
           RowBox[{"Rule", "[", 
            RowBox[{
             RowBox[{"q", "[", 
              RowBox[{"_", ",", "_"}], "]"}], ",", "s_"}], "]"}], "\[Rule]", 
           "s"}], ",", "3"}], "]"}]}], ";", "   ", 
       RowBox[{"(*", 
        RowBox[{
        "Crea", " ", "la", " ", "lista", " ", "dei", " ", "risultati", " ", 
         "cercando", " ", "al", " ", "livello", " ", "3", " ", "quel", " ", 
         "pattern", " ", "ed", " ", "estraendovi", " ", "la", " ", 
         "variabile", " ", "s"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"Acc", ",", 
            RowBox[{"i_", "/;", 
             RowBox[{
              RowBox[{"i", "\[NotEqual]", "0"}], "&&", 
              RowBox[{"i", "\[NotEqual]", "1"}], "&&", 
              RowBox[{"i", "\[NotEqual]", 
               RowBox[{"-", "1"}]}]}]}]}], "]"}], "\[NotEqual]", 
          RowBox[{"{", "}"}]}], ",", "                                ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Se", " ", "la", " ", "lista", " ", "contiene", " ", "valori", " ",
             "che", " ", "non", " ", "sono", " ", "1"}], ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"0", " ", "non", " ", "va", " ", "bene"}], ",", " ", 
           RowBox[{"farlo", " ", "con", " ", "valore", " ", 
            RowBox[{"assoluto", "?"}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"A", "=", "0"}], ";"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"A", "=", "A0"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "REGOLE", " ", "DI", " ", "SOSTITUZIONE", " ", "SULLE", " ", 
         "CARICHE"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Si", " ", "definiscono", " ", "delle", " ", "regole", " ", "di", " ",
          "sostituzione", " ", "per", " ", "le", " ", "varie", " ", "entrate",
          " ", "nel", " ", "vertice"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"datiEntranti", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Rule", "[", 
           RowBox[{
            RowBox[{"q", "[", "i", "]"}], ",", 
            RowBox[{"carichedate", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "entranti"}], "}"}]}], "]"}]}], ";", 
       "        ", 
       RowBox[{"(*", 
        RowBox[{
        "Le", " ", "cariche", " ", "di", " ", "gambe", " ", "entranti", " ", 
         "sono", " ", "sostituite", " ", "con", " ", "il", " ", "loro", " ", 
         "valore"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"datiUscenti", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Rule", "[", 
           RowBox[{
            RowBox[{"q", "[", "i", "]"}], ",", 
            RowBox[{"-", 
             RowBox[{"carichedate", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], " ", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"entranti", "+", "1"}], ",", "npt"}], "}"}]}], "]"}]}], 
       ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "Le", " ", "cariche", " ", "di", " ", "gambe", " ", "uscenti", " ", 
         "sono", " ", "sostituite", " ", "con", " ", "il", " ", "loro", " ", 
         "valore", " ", "cambiato", " ", "di", " ", "segno"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"dati", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"datiEntranti", ",", "datiUscenti"}], "]"}]}], ";", "  ", 
       "\[IndentingNewLine]", 
       RowBox[{"A1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"A", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"q", "[", 
               RowBox[{
                RowBox[{"k_", "/;", 
                 RowBox[{"k", ">", "0"}]}], ",", "t_"}], "]"}], "\[Rule]", 
              RowBox[{"q", "[", "k", "]"}]}], "}"}]}], "/.", "dati"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"q", "[", 
              RowBox[{"k_", ",", "t_"}], "]"}], "/;", 
             RowBox[{"t", ">", "k"}]}], "\[Rule]", 
            RowBox[{"-", 
             RowBox[{"q", "[", 
              RowBox[{"t", ",", "k"}], "]"}]}]}], "}"}]}], "/.", 
         "sostituzioniCariche"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"VERIFICA", " ", "SUI", " ", "VERTICI"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ListaDelleCaricheSuOgniVertice", " ", "=", " ", 
        RowBox[{"Cases", "[", 
         RowBox[{"A1", ",", 
          RowBox[{
           RowBox[{"V2", "[", 
            RowBox[{"a__", ",", "b__", ",", "c__"}], "]"}], "->", "b"}], ",", 
          "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ListaDelleSommeDiValoriAssolutiSuOgniVertice", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Apply", "[", 
            RowBox[{"Plus", ",", 
             RowBox[{"Abs", "[", "#", "]"}]}], "]"}], "&"}], ",", 
          "ListaDelleCaricheSuOgniVertice"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"ListaDelleSommeDiValoriAssolutiSuOgniVertice", ",", 
            RowBox[{"i_", "/;", 
             RowBox[{"i", "\[NotEqual]", "2"}]}]}], "]"}], "\[NotEqual]", 
          RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"A2", "=", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"A2", "=", "A1"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "REGOLE", " ", "DI", " ", "SOSTITUZIONE", " ", "PER", " ", "I", " ", 
         "MOMENTI"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"globale", ":=", 
        RowBox[{"Rule", "[", 
         RowBox[{
          RowBox[{"p", "[", "npt", "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"p", "[", "l", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", 
               RowBox[{"npt", "-", "1"}]}], "}"}]}], "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"A3", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"A2", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{
                RowBox[{"k_", "/;", 
                 RowBox[{"k", ">", "0"}]}], ",", "t_"}], "]"}], "\[Rule]", 
              RowBox[{"p", "[", "k", "]"}]}], "}"}]}], "/.", "globale"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"k_", ",", "t_"}], "]"}], "/;", 
             RowBox[{"t", ">", "k"}]}], "\[Rule]", 
            RowBox[{"-", 
             RowBox[{"p", "[", 
              RowBox[{"t", ",", "k"}], "]"}]}]}], "}"}]}], "/.", 
         RowBox[{"generaequazioni", "[", "grafo", "]"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "SOSTITUZIONE", " ", "DI", " ", "PROPAGATORI", " ", "E", " ", 
         "VERTICI", " ", "E", " ", "GAMBE", " ", "ESTERNE"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"A4", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"A3", "/.", 
           RowBox[{"{", 
            RowBox[{"Prop2", "->", "Prop3"}], "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"V2", "->", "V3"}], "}"}]}], "/.", 
         RowBox[{"{", 
          RowBox[{"Est2", "->", "Est3"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"A5", "=", 
        RowBox[{"Flatten", "[", "A4", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"risultato", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"Times", ",", "A5"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Estrazione", " ", "delle", " ", "linee", " ", "interne", " ", 
         "cariche", " ", "negativemente", " ", "per", " ", "rappresentazione",
          " ", 
         RowBox[{"grafica", ".", " ", "Si"}], " ", "usa", " ", "A", "#"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Ricerca", " ", "delle", " ", "linee", " ", "interne", " ", 
         "cariche"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"listapropagatoricarichi", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"A3", ",", " ", 
            RowBox[{
             RowBox[{"Prop2", "[", 
              RowBox[{"a_", ",", 
               RowBox[{"-", "1"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "c_", "}"}], ",", 
                 RowBox[{"{", "d_", "}"}]}], "}"}]}], "]"}], "->", 
             RowBox[{"{", 
              RowBox[{"c", ",", "d"}], "}"}]}], ",", "Infinity"}], "]"}], ",", 
          RowBox[{"Cases", "[", 
           RowBox[{"A3", ",", " ", 
            RowBox[{
             RowBox[{"Prop2", "[", 
              RowBox[{"a_", ",", "1", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "c_", "}"}], ",", 
                 RowBox[{"{", "d_", "}"}]}], "}"}]}], "]"}], "->", 
             RowBox[{"{", 
              RowBox[{"c", ",", "d"}], "}"}]}], ",", "Infinity"}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Ricerca", " ", "delle", " ", "linee", " ", "esterne", " ", 
         "cariche"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"listagambeesternecariche", " ", "=", " ", 
        RowBox[{"Cases", "[", 
         RowBox[{"grafo", ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i_", ",", "j_"}], "}"}], "/;", 
           RowBox[{
            RowBox[{"i", ">", "0"}], "  ", "&&", " ", 
            RowBox[{
             RowBox[{"carichedate", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "!=", "0"}]}]}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"listagambecariche", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Apply", "[", 
            RowBox[{"TwoWayRule", ",", "#"}], "]"}], "&"}], ",", 
          RowBox[{"Join", "[", 
           RowBox[{
           "listapropagatoricarichi", ",", "listagambeesternecariche"}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"stilelineecariche", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "->", "DotDashed"}], "  ", "&"}], ",", 
          "listagambecariche"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"risultato", "==", "0"}], ",", 
         RowBox[{"grafiammessi", "=", "grafiammessi"}], ",", ",", 
         RowBox[{"grafiammessi", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"grafiammessi", ",", 
            RowBox[{"pippo", "[", 
             RowBox[{
              RowBox[{"grafaungrafo", "[", "grafo", "]"}], ",", " ", 
              RowBox[{"EdgeStyle", "->", "stilelineecariche"}], ",", 
              RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}]}], "]"}]}], 
           "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "risultato"}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ampiezzatotale", "[", 
     RowBox[{"entranti_", ",", "a__"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "temp", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "ALCUNE", " ", "REGOLE", " ", "ALGEBRICHE", " ", "SULLE", " ", "GAMBE",
         " ", "ESTERNE"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"carichedate", "=", "a"}], ";", "\[IndentingNewLine]", 
       RowBox[{"npt", "=", 
        RowBox[{"Length", "[", "carichedate", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SP", "[", 
         RowBox[{
          RowBox[{"p", "[", "i_", "]"}], ",", 
          RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Mel", "^", "2"}], " ", "/;", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"carichedate", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "]"}], "==", "1"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"SP", "[", 
         RowBox[{
          RowBox[{"p", "[", "i_", "]"}], ",", 
          RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":=", 
        RowBox[{"0", "/;", 
         RowBox[{
          RowBox[{"carichedate", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "==", "0"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"grafi", "=", 
        RowBox[{"generagrafi", "[", 
         RowBox[{"Length", "[", "a", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"listadiagrammi", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"diagramma", "[", 
            RowBox[{"#", ",", "entranti", ",", "a"}], "]"}], "&"}], ",", 
          "grafi"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"risultato", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"Apply", "[", 
          RowBox[{"Plus", ",", 
           RowBox[{"Map", "[", 
            RowBox[{"generaampiezza", ",", "listadiagrammi"}], "]"}]}], "]"}],
          "]"}]}], ";", "\[IndentingNewLine]", "risultato"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"moduloquadroampiezza", "[", 
     RowBox[{"entranti_", ",", "a__", ",", "amp_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "temp", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"caricheentranti", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"carichedate", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "entranti"}], "}"}]}], "]"}]}], ";"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"caricheentranti", "=", " ", 
        RowBox[{"Length", "[", 
         RowBox[{"Take", "[", 
          RowBox[{"a", ",", "entranti"}], "]"}], "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
        "Tronca", " ", "la", " ", "lista", " ", "di", " ", "cariche", " ", 
         "alle", " ", "prime", " ", "entranti"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"risultato", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{
          RowBox[{"-", "amp"}], "*", 
          RowBox[{"amp", "/", 
           RowBox[{"2", "^", 
            RowBox[{"(", 
             RowBox[{"(", 
              RowBox[{"Length", "[", 
               RowBox[{"Cases", "[", 
                RowBox[{"caricheentranti", ",", "0"}], "]"}], "]"}], ")"}], 
             ")"}]}]}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{"Media", " ", "sugli", " ", "spin", " ", "entranti"}], "*)"}],
        "\[IndentingNewLine]", "risultato"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"verificaward", "[", 
     RowBox[{"entranti_", ",", "a__", ",", "ampiezza_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "temp", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"listaposizionefotoni", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{"a", ",", "0"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Tabella", " ", "di", " ", "ampiezze", " ", "in", " ", "cui", " ", 
         "avviene", " ", "la", " ", 
         RowBox[{"sostituzione", ".", " ", 
          RowBox[{"ACHTUNG", ":", " ", 
           RowBox[{"se", " ", "il", " ", "fotone", " ", "\[EGrave]", " ", 
            RowBox[{"all", "'"}], "ultimo", " ", "posto", " ", "non", " ", 
            "pu\[OGrave]", " ", "avvenire", " ", "alcuna", " ", 
            "sostituzione", " ", "e", " ", 
            RowBox[{"l", "'"}], "identit\[AGrave]", " ", "non", " ", 
            "sar\[AGrave]", " ", "verificata"}]}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ampiezzeward", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"ampiezza", "/.", 
           RowBox[{
            RowBox[{"Epsilon", "[", 
             RowBox[{"p", "[", "i", "]"}], "]"}], "->", 
            RowBox[{"p", "[", "i", "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "listaposizionefotoni"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"risultato", "=", 
        RowBox[{"Expand", "[", 
         RowBox[{"Together", "[", 
          RowBox[{"ampiezzeward", "/.", 
           RowBox[{"conservazioneenergia", "[", "proc", "]"}]}], "]"}], 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"conservazioneenergia", "[", 
     RowBox[{"entranti_", ",", "a__"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "temp", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"npt", "=", 
        RowBox[{"Length", "[", "a", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sommamomenti", "=", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"p", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "npt"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"equazione", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"Distribute", "[", 
           RowBox[{"SP", "[", 
            RowBox[{"sommamomenti", ",", "sommamomenti"}], "]"}], "]"}], "==",
           "0"}], "/.", 
         RowBox[{
          RowBox[{"p", "[", "npt", "]"}], "->", 
          RowBox[{
           RowBox[{"-", "sommamomenti"}], "+", 
           RowBox[{"p", "[", "npt", "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"risultato", "=", 
        RowBox[{"Solve", "[", 
         RowBox[{"equazione", ",", 
          RowBox[{"SP", "[", 
           RowBox[{
            RowBox[{"p", "[", "1", "]"}], ",", 
            RowBox[{"p", "[", "2", "]"}]}], "]"}]}], "]"}]}], ";", " ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"SP", "[", 
          RowBox[{
           RowBox[{"p", "[", "1", "]"}], ",", 
           RowBox[{"p", "[", "2", "]"}]}], "]"}], " ", "\[EGrave]", " ", 
         "arbitrario"}], "*)"}], "\[IndentingNewLine]", "risultato"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"raccoglidenominatori", "[", "expr_", "]"}], ":=", 
    RowBox[{"Apply", "[", 
     RowBox[{"Plus", ",", 
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Together", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"expr", ",", 
            RowBox[{"Function", "[", 
             RowBox[{"l", ",", 
              RowBox[{
               RowBox[{"Denominator", "[", "l", "]"}], "==", "#"}]}], "]"}]}],
            "]"}], "]"}], "&"}], ",", 
        RowBox[{"Union", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"Denominator", ",", 
           RowBox[{"Apply", "[", 
            RowBox[{"List", ",", "expr"}], "]"}]}], "]"}], "]"}]}], "]"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"-", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"ALGEBRA", "--"}], "--"}], "--"}], "--"}], "--"}], 
             "--"}], "--"}]}]}]}]}]}]}]}], "-"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"SP", ",", "Orderless"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SP", "/:", 
   RowBox[{
    RowBox[{"SP", "[", 
     RowBox[{"a_", ",", 
      RowBox[{"{", "mu_", "}"}]}], "]"}], 
    RowBox[{"SP", "[", 
     RowBox[{"b_", ",", 
      RowBox[{"{", "mu_", "}"}]}], "]"}]}], "=", 
   RowBox[{"SP", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SP", "/:", 
   RowBox[{
    RowBox[{"SP", "[", 
     RowBox[{"a_", ",", 
      RowBox[{"{", "mu_", "}"}]}], "]"}], "^", "2"}], "=", 
   RowBox[{"SP", "[", 
    RowBox[{"a", ",", "a"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SP", "/:", 
   RowBox[{
    RowBox[{"SP", "[", 
     RowBox[{
      RowBox[{"Epsilon", "[", "c_", "]"}], ",", "a_"}], "]"}], " ", 
    RowBox[{"SP", "[", 
     RowBox[{
      RowBox[{"Epsilon", "[", "c_", "]"}], ",", "b_"}], "]"}]}], "=", 
   RowBox[{"-", 
    RowBox[{"SP", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SP", "/:", 
   RowBox[{
    RowBox[{"SP", "[", 
     RowBox[{"a_", ",", 
      RowBox[{"Epsilon", "[", "b_", "]"}]}], "]"}], "^", "2"}], "=", 
   RowBox[{"-", 
    RowBox[{"SP", "[", 
     RowBox[{"a", ",", "a"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SP", "[", 
    RowBox[{
     RowBox[{"Epsilon", "[", "a_", "]"}], ",", 
     RowBox[{"Epsilon", "[", "a_", "]"}]}], "]"}], ":=", 
   RowBox[{"-", "4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SP", "[", 
    RowBox[{
     RowBox[{"Epsilon", "[", "a_", "]"}], ",", "a_"}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SP", "[", 
    RowBox[{
     RowBox[{"x_Integer", "*", "a_"}], ",", "b_"}], "]"}], ":=", 
   RowBox[{"x", "*", 
    RowBox[{"SP", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SP", "[", 
     RowBox[{
      RowBox[{"Epsilon", "[", "a_", "]"}], ",", 
      RowBox[{"c___", "+", 
       RowBox[{"f_.", "*", "a_"}], "+", "b___"}]}], "]"}], ":=", 
    RowBox[{"SP", "[", 
     RowBox[{
      RowBox[{"Epsilon", "[", "a", "]"}], ",", 
      RowBox[{"c", "+", "b"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"CONTRIBUTO", " ", "MOLTO", " ", "PICCOLO"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SP", "[", 
    RowBox[{"c_", ",", 
     RowBox[{"a_", "+", "b_"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"SP", "[", 
     RowBox[{"a", ",", "c"}], "]"}], "+", 
    RowBox[{"SP", "[", 
     RowBox[{"b", ",", "c"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SP", "[", 
     RowBox[{"0", ",", "0"}], "]"}], ":=", "0"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"proc", "=", 
     RowBox[{"Sequence", "[", 
      RowBox[{"3", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"+", "1"}], ",", "0", ",", "0", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"+", "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"amp", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"ampiezzatotale", "[", "proc", "]"}], "\[IndentingNewLine]", 
       RowBox[{"verificaward", "[", 
        RowBox[{"proc", ",", "amp"}], "]"}], "\[IndentingNewLine]", 
       RowBox[{"Map", "[", 
        RowBox[{"Graph", ",", "grafiammessi"}], "]"}]}], "/.", 
      RowBox[{"pippo", "->", "Sequence"}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"raccoglidenominatori", "[", "amp", "]"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"moduloquadroampiezza", "[", 
    RowBox[{"proc", ",", "amp"}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.863976343030217*^9, 3.8639763744713697`*^9}, {
   3.8639764073467016`*^9, 3.8639764719110537`*^9}, {3.863976890116166*^9, 
   3.8639769136256905`*^9}, {3.8639769529314675`*^9, 
   3.8639769548792562`*^9}, {3.8639773520511446`*^9, 
   3.8639773522169776`*^9}, {3.863977384850465*^9, 3.8639774723640537`*^9}, {
   3.8639777242132483`*^9, 3.863978013826454*^9}, {3.86397818670177*^9, 
   3.8639786782858367`*^9}, {3.863978799825635*^9, 3.8639788974216156`*^9}, {
   3.863979047061164*^9, 3.863979305111562*^9}, {3.8639793914620028`*^9, 
   3.863979433874195*^9}, {3.8640137745090885`*^9, 3.864013820221359*^9}, {
   3.8640138968309536`*^9, 3.864013899986107*^9}, {3.8640139961602235`*^9, 
   3.8640140034900775`*^9}, {3.8640141613719225`*^9, 
   3.8640141726962233`*^9}, {3.8640142249499516`*^9, 
   3.8640142430947647`*^9}, {3.8640142857073913`*^9, 
   3.8640142991292133`*^9}, {3.8640144843844533`*^9, 
   3.8640145435369043`*^9}, {3.8640146235359535`*^9, 
   3.8640146372200866`*^9}, {3.8640146710252333`*^9, 
   3.8640147055768204`*^9}, {3.864014849625483*^9, 3.864014850029662*^9}, {
   3.8640148888833675`*^9, 3.864014889239403*^9}, {3.8640150148349*^9, 
   3.8640150310381517`*^9}, {3.8640155449419346`*^9, 
   3.8640155523926973`*^9}, {3.8640156418361206`*^9, 
   3.8640156519698353`*^9}, {3.8640157753260884`*^9, 
   3.8640157948811445`*^9}, {3.8640158326401234`*^9, 3.864015832824125*^9}, {
   3.8640163272628036`*^9, 3.8640163579986944`*^9}, {3.8640163988658323`*^9, 
   3.8640164424611025`*^9}, {3.8640165194206915`*^9, 
   3.8640165874177732`*^9}, {3.864018324913121*^9, 3.8640183298022976`*^9}, {
   3.8640183907249365`*^9, 3.8640184994770885`*^9}, {3.8640185428646636`*^9, 
   3.8640185545897264`*^9}, {3.8640185942911186`*^9, 3.864018753859539*^9}, 
   3.8640187939725313`*^9, {3.8640188331585655`*^9, 3.864018839856032*^9}, {
   3.8640189001210327`*^9, 3.8640189458665094`*^9}, {3.864018979586381*^9, 
   3.86401898798554*^9}, {3.8640190254040504`*^9, 3.864019040444419*^9}, {
   3.8640191240074086`*^9, 3.864019129169434*^9}, 3.86401921056044*^9, {
   3.864019259295618*^9, 3.864019266097514*^9}, {3.864019433817897*^9, 
   3.8640194964317245`*^9}, {3.8640195367041855`*^9, 
   3.8640195655283504`*^9}, {3.864019628269174*^9, 3.8640196510572357`*^9}, {
   3.864019760311364*^9, 3.864019785292054*^9}, 3.864019827236966*^9, {
   3.864019871849184*^9, 3.864019890093561*^9}, {3.8640199475414495`*^9, 
   3.864019949300906*^9}, {3.8640246545134277`*^9, 3.8640246645377584`*^9}, {
   3.864025054746908*^9, 3.864025068609451*^9}, {3.8640252469529166`*^9, 
   3.864025289455391*^9}, {3.864025465554285*^9, 3.8640254871888885`*^9}, {
   3.864025534896262*^9, 3.8640255841351767`*^9}, {3.864025687560233*^9, 
   3.8640256990825267`*^9}, {3.8640259469451623`*^9, 
   3.8640259513278627`*^9}, {3.8640259889971128`*^9, 
   3.8640260841595383`*^9}, {3.864026200768907*^9, 3.8640263743838844`*^9}, {
   3.864026424813414*^9, 3.8640264332131767`*^9}, {3.8640264799834337`*^9, 
   3.864026495522621*^9}, {3.8640265262097588`*^9, 3.864026596739199*^9}, {
   3.864026710197151*^9, 3.8640267103676596`*^9}, {3.8640267530922422`*^9, 
   3.8640267617654486`*^9}, {3.8640268406685467`*^9, 3.864026914219668*^9}, {
   3.8640279766254883`*^9, 3.8640280055860643`*^9}, {3.864032223847325*^9, 
   3.864032226274252*^9}, {3.8640325274212685`*^9, 3.864032533092763*^9}, {
   3.8640349756027765`*^9, 3.864035014458011*^9}, {3.8640375856424665`*^9, 
   3.8640379618031054`*^9}, {3.8640391248213973`*^9, 3.864039125077707*^9}, {
   3.8640400778145437`*^9, 3.8640400781487684`*^9}, {3.864040266895881*^9, 
   3.864040269307873*^9}, {3.8640406355636597`*^9, 3.864040635790848*^9}, {
   3.8640411697490063`*^9, 3.8640411713389792`*^9}, {3.864041224394493*^9, 
   3.864041238600486*^9}, {3.8640412917474084`*^9, 3.864041327870449*^9}, {
   3.8640413664298496`*^9, 3.864041370816147*^9}, {3.864041481214357*^9, 
   3.864041484268278*^9}, {3.864041528358996*^9, 3.864041558555317*^9}, {
   3.864041902598366*^9, 3.8640419035022635`*^9}, {3.8640420406950407`*^9, 
   3.864042083562972*^9}, {3.864042214534*^9, 3.8640422627637286`*^9}, {
   3.8640423207789526`*^9, 3.864042388802925*^9}, {3.864042458883851*^9, 
   3.8640425608538885`*^9}, {3.8640426105727253`*^9, 3.864042612213508*^9}, {
   3.864043066762994*^9, 3.8640430865715103`*^9}, {3.8640437532302313`*^9, 
   3.8640437544841957`*^9}, {3.86404386490818*^9, 3.86404394636349*^9}, {
   3.8640439920840607`*^9, 3.864043993862898*^9}, {3.8640440425270767`*^9, 
   3.8640441159700584`*^9}, {3.8640463669380183`*^9, 
   3.8640463861009483`*^9}, {3.864046447293463*^9, 3.8640464728897696`*^9}, {
   3.8640465180401797`*^9, 3.8640465313751745`*^9}, {3.864046562708926*^9, 
   3.8640465632672997`*^9}, {3.864046626314739*^9, 3.864046631920663*^9}, {
   3.864046680810169*^9, 3.8640467073846865`*^9}, {3.86404676246564*^9, 
   3.864046775287732*^9}, {3.8640472201518097`*^9, 3.864047220303524*^9}, {
   3.8641185055408316`*^9, 3.864118505694891*^9}, {3.864118542919588*^9, 
   3.86411855880643*^9}, {3.8641186411988707`*^9, 3.864118653955072*^9}, {
   3.8641186932321844`*^9, 3.864118703283778*^9}, 3.8641392497484193`*^9, {
   3.8641395229001656`*^9, 3.8641395523527017`*^9}, {3.8641396738432455`*^9, 
   3.864139680325392*^9}, {3.864139714547407*^9, 3.864139722299776*^9}, 
   3.8641410899480734`*^9, {3.865155907735012*^9, 3.865155909201693*^9}, {
   3.865156184261267*^9, 3.8651562006812215`*^9}, 3.8651562339517775`*^9, {
   3.8653343504970236`*^9, 3.865334359193034*^9}, {3.865699898412379*^9, 
   3.8656999883314295`*^9}, {3.8657542939711227`*^9, 
   3.8657542942511835`*^9}, {3.8657544787358084`*^9, 3.8657545091463537`*^9}, 
   3.8657545648043857`*^9, {3.8657545971134033`*^9, 3.8657546864305997`*^9}, {
   3.8657548065489483`*^9, 3.8657549064481406`*^9}, {3.865755112533125*^9, 
   3.8657552514459324`*^9}, {3.865755284279257*^9, 3.8657552899205847`*^9}, 
   3.865755335783021*^9, {3.8657553744724855`*^9, 3.8657554410069475`*^9}, {
   3.8657554736013613`*^9, 3.8657555463659987`*^9}, {3.865755632133074*^9, 
   3.865755690806738*^9}, {3.8657557327730527`*^9, 3.865755808147763*^9}, {
   3.8657559827951593`*^9, 3.8657560065010138`*^9}, {3.865756053248844*^9, 
   3.865756056150715*^9}, {3.865756698840147*^9, 3.865756728354719*^9}, {
   3.865756783426005*^9, 3.865756803952757*^9}, 3.8657573564703007`*^9, 
   3.8657574338622384`*^9, {3.8657575525630245`*^9, 3.8657575995428267`*^9}, {
   3.865757653845499*^9, 3.8657577045579295`*^9}, {3.865757939039787*^9, 
   3.8657579558870077`*^9}, {3.865758150253611*^9, 3.865758151834633*^9}, {
   3.8657582008845778`*^9, 3.8657582019146166`*^9}, {3.8657582477679048`*^9, 
   3.8657582678866158`*^9}, {3.865758313464302*^9, 3.865758405108116*^9}, 
   3.865758578606265*^9, 3.8657586855654235`*^9, {3.865759993241807*^9, 
   3.8657600216687255`*^9}, {3.865760087208147*^9, 3.8657601505007076`*^9}, {
   3.865760182077504*^9, 3.8657602855026207`*^9}, {3.865760382324329*^9, 
   3.86576058724454*^9}, {3.865760630881161*^9, 3.865760670668702*^9}, {
   3.865760712321473*^9, 3.865760712956155*^9}, {3.865760767607684*^9, 
   3.865760776223914*^9}, {3.865760873041676*^9, 3.865761160802101*^9}, {
   3.865762242937364*^9, 3.865762268189687*^9}, {3.8657623537218266`*^9, 
   3.8657623641134443`*^9}, {3.8657624201039457`*^9, 
   3.8657624517728205`*^9}, {3.86576256989122*^9, 3.8657627754443636`*^9}, {
   3.865762843158248*^9, 3.8657628631592894`*^9}, {3.865763031952463*^9, 
   3.8657630929686975`*^9}, {3.865763153938199*^9, 3.865763159680028*^9}, {
   3.8657635372530136`*^9, 3.865763542231783*^9}, {3.8657820565777326`*^9, 
   3.865782060343107*^9}, {3.8657822859826565`*^9, 3.8657822878301215`*^9}, {
   3.8660236357394133`*^9, 3.866023643476697*^9}, {3.866023679023656*^9, 
   3.8660238311160216`*^9}, {3.866023873569837*^9, 3.866023875029402*^9}, {
   3.8660239173862963`*^9, 3.8660239405431404`*^9}, {3.866024033779388*^9, 
   3.866024036118663*^9}, {3.8660241159469833`*^9, 3.8660242552783365`*^9}, {
   3.866024319192309*^9, 3.8660244040412664`*^9}, {3.866024483434449*^9, 
   3.8660245389643307`*^9}, {3.8660252941764183`*^9, 
   3.8660253957384267`*^9}, {3.8660270457896585`*^9, 3.866027077679158*^9}, {
   3.8660275749084816`*^9, 3.866027658039572*^9}, {3.866027701478904*^9, 
   3.8660277059212055`*^9}, {3.866027760604725*^9, 3.8660278285648203`*^9}, {
   3.8660278867964706`*^9, 3.8660279392294903`*^9}, {3.866027984183958*^9, 
   3.8660279867721653`*^9}, {3.8660281189985733`*^9, 3.866028172648821*^9}, {
   3.8660285277418756`*^9, 3.866028634527872*^9}, {3.8660286974171357`*^9, 
   3.8660287127714233`*^9}, {3.8660287661644936`*^9, 
   3.8660288569488897`*^9}, {3.866028893936536*^9, 3.8660289243758373`*^9}, {
   3.866029001759205*^9, 3.866029003701347*^9}, {3.866044972310522*^9, 
   3.8660450192346377`*^9}, {3.866046304502102*^9, 3.86604631611977*^9}, {
   3.8660463810801744`*^9, 3.8660463848933663`*^9}, {3.8660465099783773`*^9, 
   3.866046590626788*^9}, {3.8660466340358686`*^9, 3.8660466670004797`*^9}, {
   3.866046889502404*^9, 3.866046927019081*^9}, 3.866047317642399*^9, {
   3.866047395341652*^9, 3.866047458683095*^9}, {3.866047512941246*^9, 
   3.8660475594065595`*^9}, {3.8660475961698184`*^9, 3.866047629798667*^9}, {
   3.8660476600657735`*^9, 3.866047683709462*^9}, {3.866047832694105*^9, 
   3.8660478433582587`*^9}, {3.8660482902007504`*^9, 3.866048351241005*^9}, {
   3.866048699462617*^9, 3.866048854600828*^9}, {3.866048931937727*^9, 
   3.866048943214026*^9}, {3.866048974610174*^9, 3.8660490260779552`*^9}, {
   3.866049087182787*^9, 3.8660490898697343`*^9}, {3.866049120582448*^9, 
   3.866049191161914*^9}, {3.8660492469034595`*^9, 3.866049287746339*^9}, {
   3.8660493436747046`*^9, 3.8660493668216267`*^9}, {3.866049457169182*^9, 
   3.8660495514474893`*^9}, {3.8660495918909736`*^9, 3.8660495946948547`*^9}, 
   3.866049631639168*^9, {3.8660498669705267`*^9, 3.8660498709911227`*^9}, {
   3.86605023121488*^9, 3.866050255407378*^9}, {3.866050302037323*^9, 
   3.86605033411243*^9}, {3.8660503791530075`*^9, 3.866050396907541*^9}, {
   3.8660507049711065`*^9, 3.86605074058133*^9}, {3.866050772991595*^9, 
   3.8660507807618666`*^9}, {3.8660508360107145`*^9, 3.866050874217415*^9}, {
   3.866050976556902*^9, 3.86605105518323*^9}, {3.8660519407477603`*^9, 
   3.8660520055810685`*^9}, {3.866052100677535*^9, 3.866052138359538*^9}, {
   3.866052174155755*^9, 3.866052189546406*^9}, {3.866052244165584*^9, 
   3.8660523257547054`*^9}, {3.8660523928339663`*^9, 3.866052437481045*^9}, {
   3.8660524896891966`*^9, 3.8660524963669167`*^9}, {3.866052634188159*^9, 
   3.8660526818729525`*^9}, {3.8660527261975985`*^9, 
   3.8660527690567036`*^9}, {3.866052918609505*^9, 3.8660529324218884`*^9}, {
   3.8660530489189253`*^9, 3.8660530537281585`*^9}, {3.8660532467681875`*^9, 
   3.866053294727557*^9}, {3.8660533281630917`*^9, 3.8660533535834846`*^9}, {
   3.866099792013991*^9, 3.866099802843961*^9}, {3.8660999383610983`*^9, 
   3.8660999632838883`*^9}, {3.8661000232246237`*^9, 3.866100099991276*^9}, {
   3.866100142765769*^9, 3.8661002618879805`*^9}, {3.866100295880126*^9, 
   3.866100351842703*^9}, {3.866100382868369*^9, 3.8661004328962135`*^9}, {
   3.8661006090853043`*^9, 3.866100612118487*^9}, {3.866100895574684*^9, 
   3.866100927253153*^9}, {3.8661009617023516`*^9, 3.8661009750546618`*^9}, {
   3.866101872637669*^9, 3.8661018969431176`*^9}, {3.866103305507307*^9, 
   3.8661035464118967`*^9}, {3.8661036059393406`*^9, 3.866103612193763*^9}, {
   3.866103749856132*^9, 3.8661037521216297`*^9}, {3.866103795889432*^9, 
   3.866103835753261*^9}, {3.8661045200323963`*^9, 3.8661046964016285`*^9}, {
   3.866104898964945*^9, 3.866104999497182*^9}, {3.866105036811146*^9, 
   3.8661051133850155`*^9}, {3.8661052072675834`*^9, 3.866105239116435*^9}, 
   3.866105271938651*^9, {3.8661053139693747`*^9, 3.866105322690086*^9}, {
   3.8661053950143323`*^9, 3.8661053955104055`*^9}, {3.8661055159201665`*^9, 
   3.866105577018592*^9}, {3.8661057140603175`*^9, 3.8661058799556875`*^9}, {
   3.8661059221431437`*^9, 3.8661059940527625`*^9}, {3.8661060915317698`*^9, 
   3.8661061209005666`*^9}, {3.8661062514250393`*^9, 3.866106263091536*^9}, {
   3.8661063159704876`*^9, 3.8661063363934307`*^9}, {3.8661064346834316`*^9, 
   3.866106580428196*^9}, {3.866106834694395*^9, 3.8661069688430467`*^9}, {
   3.86610701007725*^9, 3.866107043679782*^9}, {3.8661071298081303`*^9, 
   3.8661071561368*^9}, {3.866107243093959*^9, 3.866107263442541*^9}, {
   3.8661075602568088`*^9, 3.8661075618351045`*^9}, {3.866107613890679*^9, 
   3.866107643362003*^9}, {3.866107708903247*^9, 3.866107770299512*^9}, {
   3.8661078711129293`*^9, 3.866107884163172*^9}, {3.8661080504118595`*^9, 
   3.866108136415103*^9}, {3.866108187117354*^9, 3.8661082145141335`*^9}, {
   3.8661083838022795`*^9, 3.8661083917412534`*^9}, {3.8661084435920153`*^9, 
   3.8661084452655773`*^9}, {3.866108524114217*^9, 3.8661085943247976`*^9}, {
   3.86610862927675*^9, 3.8661086305615683`*^9}, {3.8661089861005163`*^9, 
   3.866109039879257*^9}, {3.8661095591339383`*^9, 3.86610957266197*^9}, {
   3.8661096178772645`*^9, 3.866109672070937*^9}, {3.866109716271084*^9, 
   3.8661097289819107`*^9}, {3.8661099029606485`*^9, 3.86610993402594*^9}, {
   3.8661118800540247`*^9, 3.866111880081987*^9}, {3.8661399032748947`*^9, 
   3.8661399276880035`*^9}, {3.8661409954288144`*^9, 3.866141001425763*^9}, {
   3.8661410509737487`*^9, 3.8661410599633727`*^9}, {3.866141102540445*^9, 
   3.866141121741351*^9}, {3.866141269997888*^9, 3.8661412899002976`*^9}, {
   3.866141695931464*^9, 3.866141738791057*^9}, {3.8661605021450624`*^9, 
   3.8661605035986605`*^9}, {3.866160878880992*^9, 3.8661608841134377`*^9}, {
   3.866161681340358*^9, 3.8661616826910524`*^9}, {3.866161744820149*^9, 
   3.8661618219524765`*^9}, {3.8661618590524144`*^9, 3.866161906656546*^9}, {
   3.866161958280495*^9, 3.8661619855856533`*^9}, {3.8661621127930717`*^9, 
   3.8661621897560205`*^9}, {3.866162232603078*^9, 3.8661622475683684`*^9}, {
   3.866167698787056*^9, 3.8661677045476217`*^9}, {3.866169858675623*^9, 
   3.866169866962256*^9}, {3.866169908219926*^9, 3.8661699107706757`*^9}, {
   3.866172093084285*^9, 3.8661720985375123`*^9}, {3.866178321343856*^9, 
   3.8661783216839476`*^9}, {3.8661783895300226`*^9, 3.866178390349823*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"9b9ca76a-6383-4659-b601-d242e76fda7f"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Diagrammi", " ", "a", " ", "un", " ", "loop"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"grafobaseloop", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"pluto", ",", "Orderless"}], "]"}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"trovaloop", "[", "grafo_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "temp", "}"}], ",", "    ", 
       RowBox[{"(*", 
        RowBox[{
        "DATO", " ", "IL", " ", "GRAFO", " ", "RESTITUISCE", " ", "UNA", " ", 
         "LINEA", " ", "QUALUNQUE", " ", "DEL", " ", "LOOP"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"loop", "=", 
         RowBox[{"FindCycle", "[", 
          RowBox[{"grafaungrafo", "[", "grafo", "]"}], "]"}]}], ";", "  ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "FIND", " ", "CYCLE", " ", "CERCA", " ", "TRA", " ", "OGGETTO", " ",
            "DI", " ", "TIPO", " ", "GRAPH"}], " ", "<->"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"loop", "==", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", " ", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"I", " ", "SELF", " ", "LOOP", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1"}]}], "}"}], " ", "FINDCYCLE", " ", "NON", " ",
              "LI", " ", "VEDE"}], ",", " ", 
            RowBox[{
            "DOBBIAMO", " ", "METTERLI", " ", "NOI", " ", "A", " ", 
             "MANO"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Apply", "[", 
           RowBox[{"List", ",", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"loop", ",", 
               RowBox[{"UndirectedEdge", "[", 
                RowBox[{
                 RowBox[{"-", "1"}], ",", "_"}], "]"}], ",", 
               RowBox[{"-", "1"}]}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "  ", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Seleziono", " ", "uno", " ", "delle", " ", "linee", " ", "del", 
            " ", 
            RowBox[{"loop", ".", " ", "Prendo"}], " ", "il", " ", "primo", 
            " ", "che", " ", "contenga"}], " ", "-", "1"}], "*)"}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"testtopologico", "[", "grafo_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "temp", "}"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"VERIFICHE", " ", "TOPOLOGICHE"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"ELIMINAZIONE", " ", "DEI", " ", "TADPOLE"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"loop", "=", 
         RowBox[{"trovaloop", "[", "grafo", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"loop", "==", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", 
              RowBox[{"-", "1"}]}], "}"}]}], " ", "&&", " ", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{"grafo", ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "1"}], ",", "t_"}], "}"}], "->", "t"}]}], 
              "]"}], "]"}], "==", "2"}]}], ",", 
          RowBox[{
           RowBox[{"testtadpole", "=", "0"}], ";"}], ",", 
          RowBox[{"testtadpole", "=", "1"}]}], "]"}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "\[EGrave]", " ", "un", " ", "tadpole", " ", "se", " ", "il", " ", 
           "loop", " ", "\[EGrave]", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}], ","}], "}"}], " ", "e", " ", "e", " ", "ci", 
           " ", "sono", " ", "solo", " ", "due", " ", "linee", " ", 
           "attaccate", " ", "a"}], " ", "-", "1"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"IL", " ", "LOOP", " ", 
          RowBox[{"E", "'"}], " ", "UNA", " ", "CORREZIONE", " ", "AD", " ", 
          "UNA", " ", "GAMBA", " ", 
          RowBox[{"ESTERNA", "?"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"primo", " ", 
          RowBox[{"punto", ":", " ", 
           RowBox[{
           "uno", " ", "dei", " ", "due", " ", "estermi", " ", "\[EGrave]", 
            " ", "connesso", " ", "ad", " ", "una", " ", "gamba"}]}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"estremilooppositivi", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"grafo", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"t_", ",", 
                 RowBox[{"loop", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "/;", 
               RowBox[{"t", ">", "0"}]}], "->", "t"}]}], "]"}], ",", 
           RowBox[{"Cases", "[", 
            RowBox[{"grafo", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"t_", ",", 
                 RowBox[{"loop", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "/;", 
               RowBox[{"t", ">", "0"}]}], "->", "t"}]}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"secondo", " ", 
           RowBox[{"punto", ":", " ", 
            RowBox[{
            "uno", " ", "dei", " ", "due", " ", "estremi", " ", "del", " ", 
             "loop", " ", "\[EGrave]", " ", "connesso", " ", "ad", " ", "un", 
             " ", "propagatore"}]}]}], ",", " ", 
          RowBox[{"ossia", " ", "NON", " ", "UN", " ", "VERTICE"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"grafonl", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"grafo", ",", "loop"}], "]"}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
         "tolgo", " ", "dal", " ", "grafo", " ", "le", " ", "linee", " ", 
          "di", " ", "loop"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"estremiloopnegativi", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"grafonl", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"loop", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", "t_"}], "}"}], "/;", 
               RowBox[{"t", "<", "0"}]}], "->", "t"}]}], "]"}], ",", 
           RowBox[{"Cases", "[", 
            RowBox[{"grafonl", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"loop", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", "t_"}], "}"}], "/;", 
               RowBox[{"t", "<", "0"}]}], "->", "t"}]}], "]"}], ",", 
           RowBox[{"Cases", "[", 
            RowBox[{"grafonl", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"t_", ",", 
                 RowBox[{"loop", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "/;", 
               RowBox[{"t", "<", "0"}]}], "->", "t"}]}], "]"}], ",", 
           RowBox[{"Cases", "[", 
            RowBox[{"grafonl", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"t_", ",", 
                 RowBox[{"loop", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "/;", 
               RowBox[{"t", "<", "0"}]}], "->", "t"}]}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"estremiloopnegativi", "=", 
         RowBox[{"DeleteDuplicates", "[", "estremiloopnegativi", "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"estremilooppositivi", "=", 
         RowBox[{"DeleteDuplicates", "[", "estremilooppositivi", "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "estremilooppositivi", "]"}], "==", "1"}], 
           " ", "&&", 
           RowBox[{
            RowBox[{"Length", "[", "estremiloopnegativi", "]"}], "==", 
            "1"}]}], ",", 
          RowBox[{
           RowBox[{"testgambeesterne", "=", "0"}], ";"}], ",", 
          RowBox[{"testgambeesterne", "=", "1"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"test", "=", 
         RowBox[{"testgambeesterne", "*", "testtadpole"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"generagrafiloop", "[", "n_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "temp", "}"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"listagrafi", "=", 
         RowBox[{"{", "grafobaseloop", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{"i", "<", "n"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"nuovigrafi3", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{"inserzione3", ",", "listagrafi"}], "]"}], ",", "1"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"nuovigrafi4", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{"inserzione4", ",", "listagrafi"}], "]"}], ",", "1"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"listagrafi", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"nuovigrafi3", ",", "nuovigrafi4"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"++", "i"}], ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Questi", " ", "procedimento", " ", "crea", " ", "dei", " ", 
          "duplicati", " ", "che", " ", "bisogna", " ", 
          RowBox[{"cancellare", ".", " ", "Non"}], " ", "si", " ", 
          "pu\[OGrave]", " ", "usare", " ", "direttamente", " ", 
          "DeleteDuplicates", " ", "perch\[EAcute]", " ", "le", " ", "liste", 
          " ", "non", " ", "sono", " ", 
          RowBox[{"orderless", ".", " ", "Allora"}], " ", "si", " ", 
          "sostituisce", " ", "temporaneamente", " ", "un", " ", "Head", " ", 
          "orderless"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"listagrafi", "=", 
         RowBox[{
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Apply", "[", 
               RowBox[{"pluto", ",", "#"}], "]"}], "&"}], ",", "listagrafi"}],
             "]"}], "]"}], "/.", 
          RowBox[{"(", 
           RowBox[{"pluto", "->", "List"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"risultato", "=", 
         RowBox[{"Select", "[", 
          RowBox[{"listagrafi", ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"testtopologico", "[", "#", "]"}], "==", "1"}], " ", 
            "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", "risultato"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sostituiscimomentoloop", "[", 
      RowBox[{"lista_", ",", "loop_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "temp", "}"}], ",", " ", 
       RowBox[{"(*", 
        RowBox[{
        "Data", " ", "una", " ", "lista", " ", "che", " ", "contenga", " ", 
         "il", " ", "momento", " ", "di", " ", "loop", " ", "lo", " ", 
         "sostituisce", " ", "con", " ", 
         RowBox[{"k", "[", "loop", "]"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"loops", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"Sequence", ",", "loop"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"posizioneploop", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"lista", ",", 
           RowBox[{"p", "[", "loops", "]"}], ",", 
           RowBox[{"-", "1"}], ",", "1"}], "]"}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
         "Prende", " ", "solo", " ", "il", " ", "primo", " ", "che", " ", 
          "trova"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ReplacePart", "[", 
         RowBox[{"lista", ",", 
          RowBox[{"k", "[", "loops", "]"}], ",", "posizioneploop"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"sostituiscicaricaloop", "[", 
      RowBox[{"lista_", ",", "loop_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "temp", "}"}], ",", " ", 
       RowBox[{"(*", 
        RowBox[{
        "Data", " ", "una", " ", "lista", " ", "che", " ", "contenga", " ", 
         "la", " ", "carica", " ", "di", " ", "loop", " ", "la", " ", 
         "sostituisce", " ", "con", " ", 
         RowBox[{"s", "[", "loop", "]"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"loops", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"Sequence", ",", "loop"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"posizioneqloop", "=", 
         RowBox[{"Position", "[", 
          RowBox[{"lista", ",", 
           RowBox[{"q", "[", "loops", "]"}], ",", 
           RowBox[{"-", "1"}], ",", "1"}], "]"}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
         "Prende", " ", "solo", " ", "il", " ", "primo", " ", "che", " ", 
          "trova"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ReplacePart", "[", 
         RowBox[{"lista", ",", 
          RowBox[{"s", "[", "loops", "]"}], ",", "posizioneqloop"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"generaequazioniloop", "[", "grafo_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "temp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"indici", "=", 
         RowBox[{"Flatten", "[", "grafo", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"npt", "=", 
         RowBox[{"Max", "[", "indici", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nvert", "=", 
         RowBox[{"Min", "[", "indici", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"loop", "=", 
         RowBox[{"trovaloop", "[", "grafo", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"impulsi", "=", 
         RowBox[{"listaimpulsi", "[", "grafo", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"impulsi", "=", 
         RowBox[{"sostituiscimomentoloop", "[", 
          RowBox[{"impulsi", ",", "loop"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"equazioni", "=", 
         RowBox[{
         "Table", "[", 
          "                                                                   \
    ", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "Si", " ", "cicla", " ", "su", " ", "ogni", " ", "vertice"}], ",",
             " ", 
            RowBox[{
            "di", " ", "modo", " ", "da", " ", "otterne", " ", "una", " ", 
             "lista", " ", "di", " ", "leggi", " ", "di", " ", 
             "conservazione"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"impulsivertice", "=", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{"impulsi", ",", 
                 RowBox[{"_", "[", 
                  RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"Cases", "[", 
                 RowBox[{"impulsi", ",", 
                  RowBox[{"_", "[", 
                   RowBox[{"i", ",", "_"}], "]"}]}], "]"}]}]}], "]"}]}], ";", 
            " ", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "Per", " ", "ogni", " ", "vertice", " ", "si", " ", "prendono", 
               " ", "gli", " ", "impulsi", " ", "corrispondenti"}], ",", " ", 
              RowBox[{
              "che", " ", "siao", " ", "a", " ", "sinistra", " ", "o", " ", 
               "a", " ", "destra"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{"Plus", ",", "impulsivertice"}], "]"}], "\[Equal]", 
             "0"}]}], ",", 
           "                                                                  \
                            ", 
           RowBox[{"(*", 
            RowBox[{
            "Somma", " ", "gli", " ", "impulsi", " ", "di", " ", "tale", " ", 
             "lista", " ", "cambiando", " ", "head"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"-", "1"}], ",", "nvert", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"equazioni", "=", 
         RowBox[{"equazioni", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"p", "[", 
             RowBox[{
              RowBox[{"a_", "/;", 
               RowBox[{"a", ">", "0"}]}], ",", "t_"}], "]"}], "\[Rule]", 
            RowBox[{"p", "[", "a", "]"}]}], "}"}]}]}], ";", "      ", 
        RowBox[{"(*", 
         RowBox[{
         "Applico", " ", "regola", " ", "di", " ", "sostituzione", " ", 
          "agli", " ", "impulsi", " ", "delle", " ", "linee", " ", 
          "entranti"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"equazioni", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"equazioni", ",", "True"}], "]"}]}], ";", 
        RowBox[{"incognite", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"equazioni", ",", 
           RowBox[{"p", "[", ",", "]"}], ",", "Infinity"}], "]"}]}], ";", 
        "             ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Ora", " ", "le", " ", "incognite", " ", "sono", " ", "tutti", " ", 
           "i", " ", "momenti", " ", "che", " ", "hanno", " ", "due", " ", 
           "indici"}], ",", " ", 
          RowBox[{"ossia", " ", "quelli", " ", "interni"}]}], "*)"}], "  ", 
        "\n", "     ", 
        RowBox[{"globale", "=", 
         RowBox[{"Rule", "[", 
          RowBox[{
           RowBox[{"p", "[", "npt", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"p", "[", "i", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"npt", "-", "1"}]}], "}"}]}], "]"}]}]}], "]"}]}], ";",
         "  ", "\n", "     ", 
        RowBox[{"equazioni", "=", 
         RowBox[{"equazioni", "/.", "globale"}]}], ";", "\n", "     ", 
        RowBox[{"impulsiinterni", "=", 
         RowBox[{"Solve", "[", 
          RowBox[{"equazioni", ",", "incognite"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "impulsiinterni"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"generaequazionicaricheloop", "[", "diagramma_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "temp", "}"}], ",", "   ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"grafo", "=", 
         RowBox[{"diagramma", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"entranti", "=", 
         RowBox[{"diagramma", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"carichedate", "=", 
         RowBox[{"diagramma", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", 
        "                                                                     \
                            ", "\[IndentingNewLine]", 
        RowBox[{"indici", "=", 
         RowBox[{"Flatten", "[", "grafo", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"npt", "=", 
         RowBox[{"Max", "[", "indici", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nvert", "=", 
         RowBox[{"Min", "[", "indici", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"loop", "=", 
         RowBox[{"trovaloop", "[", "grafo", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"cariche", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"q", ",", "#"}], "]"}], "&"}], ",", "grafo"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"cariche", "=", 
         RowBox[{"sostituiscicaricaloop", "[", 
          RowBox[{"cariche", ",", "loop"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"equazioni", "=", 
         RowBox[{
         "Table", "[", 
          "                                                                   \
    ", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "Si", " ", "cicla", " ", "su", " ", "ogni", " ", "vertice"}], ",",
             " ", 
            RowBox[{
            "di", " ", "modo", " ", "da", " ", "otterne", " ", "una", " ", 
             "lista", " ", "di", " ", "leggi", " ", "di", " ", 
             "conservazione"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"carichevertice", "=", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{"cariche", ",", 
                 RowBox[{"_", "[", 
                  RowBox[{"_", ",", "i"}], "]"}]}], "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"Cases", "[", 
                 RowBox[{"cariche", ",", 
                  RowBox[{"_", "[", 
                   RowBox[{"i", ",", "_"}], "]"}]}], "]"}]}]}], "]"}]}], ";", 
            " ", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "Per", " ", "ogni", " ", "vertice", " ", "si", " ", "prendono", 
               " ", "le", " ", "cariche", " ", "corrispondenti"}], ",", " ", 
              RowBox[{
              "che", " ", "siano", " ", "a", " ", "sinistra", " ", "o", " ", 
               "a", " ", "destra"}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{"Plus", ",", "carichevertice"}], "]"}], "\[Equal]", 
             "0"}]}], ",", 
           "                                                                  \
                            ", 
           RowBox[{"(*", 
            RowBox[{
            "Somma", " ", "le", " ", "cariche", " ", "di", " ", "tale", " ", 
             "lista", " ", "cambiando", " ", "head"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"-", "1"}], ",", "nvert", ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"datiEntranti", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Rule", "[", 
            RowBox[{
             RowBox[{"q", "[", 
              RowBox[{"i", ",", "_"}], "]"}], ",", 
             RowBox[{"carichedate", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "entranti"}], "}"}]}], "]"}]}], ";", 
        "        ", 
        RowBox[{"(*", 
         RowBox[{
         "Le", " ", "cariche", " ", "di", " ", "gambe", " ", "entranti", " ", 
          "sono", " ", "sostituite", " ", "con", " ", "il", " ", "loro", " ", 
          "valore"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"datiUscenti", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Rule", "[", 
            RowBox[{
             RowBox[{"q", "[", 
              RowBox[{"i", ",", "_"}], "]"}], ",", 
             RowBox[{"-", 
              RowBox[{"carichedate", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], " ", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"entranti", "+", "1"}], ",", "npt"}], "}"}]}], "]"}]}], 
        ";", " ", 
        RowBox[{"(*", 
         RowBox[{
         "Le", " ", "cariche", " ", "di", " ", "gambe", " ", "uscenti", " ", 
          "sono", " ", "sostituite", " ", "con", " ", "il", " ", "loro", " ", 
          "valore", " ", "cambiato", " ", "di", " ", "segno"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"dati", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"datiEntranti", ",", "datiUscenti"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"equazioni", "=", 
         RowBox[{"equazioni", "/.", " ", "dati"}]}], ";", "      ", 
        RowBox[{"(*", 
         RowBox[{
         "Applico", " ", "regola", " ", "di", " ", "sostituzione", " ", "a", 
          " ", "tali", " ", "cariche"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "equazioni", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"incognite", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"equazioni", ",", 
           RowBox[{"q", "[", 
            RowBox[{"_", ",", "_"}], "]"}], ",", "Infinity"}], "]"}]}], ";", 
        "             ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Ora", " ", "le", " ", "incognite", " ", "sono", " ", "tutti", " ", 
           "i", " ", "momenti", " ", "che", " ", "hanno", " ", "due", " ", 
           "indici"}], ",", " ", 
          RowBox[{"ossia", " ", "quelli", " ", "entranti"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"caricheinterne", "=", 
         RowBox[{"Solve", "[", 
          RowBox[{"equazioni", ",", "incognite"}], "]"}]}]}]}], 
      "                      ", 
      RowBox[{"(*", 
       RowBox[{"LA", " ", "SOLUZIONE", " ", 
        RowBox[{"E", "'"}], " ", "IN", " ", "FUNZIONE", " ", "DI", " ", "S"}],
        "*)"}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"generaampiezzaloop", "[", "diagramma_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "temp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"grafo", "=", 
         RowBox[{"diagramma", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"entranti", "=", 
         RowBox[{"diagramma", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"carichedate", "=", 
         RowBox[{"diagramma", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"indici", "=", 
         RowBox[{"Flatten", "[", "grafo", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"npt", "=", 
         RowBox[{"Max", "[", "indici", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nvert", "=", 
         RowBox[{"Min", "[", "indici", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"loop", "=", 
         RowBox[{"trovaloop", "[", "grafo", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Usando", " ", "il", " ", "codice", " ", "gi\[AGrave]", " ", 
           "sviluppato", " ", "si", " ", "scrivono", " ", "le", " ", "liste", 
           " ", "di", " ", "linee", " ", "esterne"}], ",", " ", 
          RowBox[{"propagatori", " ", "e", " ", "vertici"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"LLE", "=", 
         RowBox[{"listalineeesterne", "[", "grafo", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"LP", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"listapropagatori", "[", "grafo", "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"q", "[", 
               RowBox[{"k_", ",", "t_"}], "]"}], "/;", 
              RowBox[{"t", ">", "k"}]}], "\[Rule]", 
             RowBox[{"-", 
              RowBox[{"q", "[", 
               RowBox[{"t", ",", "k"}], "]"}]}]}], "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"k_", ",", "t_"}], "]"}], "/;", 
             RowBox[{"t", ">", "k"}]}], "\[Rule]", 
            RowBox[{"-", 
             RowBox[{"p", "[", 
              RowBox[{"t", ",", "k"}], "]"}]}]}], "}"}]}]}], ";", " ", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Affinch\[EAcute]", " ", "la", " ", "sostituzione", " ", "di", " ", 
           "cariche", " ", "abbia", " ", "successo", " ", "questo", " ", 
           "bisogna", " ", "farlo", " ", "subito"}], ",", " ", 
          RowBox[{
          "dove", " ", "prima", " ", "bisognava", " ", "farlo", " ", 
           "subito"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"LP", "=", 
         RowBox[{"sostituiscimomentoloop", "[", 
          RowBox[{"LP", ",", "loop"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"LP", "=", 
         RowBox[{"sostituiscicaricaloop", "[", 
          RowBox[{"LP", ",", "loop"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"LV", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"listavertici", "[", "grafo", "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"q", "[", 
               RowBox[{"k_", ",", "t_"}], "]"}], "/;", 
              RowBox[{"t", ">", "k"}]}], "\[Rule]", 
             RowBox[{"-", 
              RowBox[{"q", "[", 
               RowBox[{"t", ",", "k"}], "]"}]}]}], "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"k_", ",", "t_"}], "]"}], "/;", 
             RowBox[{"t", ">", "k"}]}], "\[Rule]", 
            RowBox[{"-", 
             RowBox[{"p", "[", 
              RowBox[{"t", ",", "k"}], "]"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"LV", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"sostituiscimomentoloop", "[", 
             RowBox[{"#", ",", "loop"}], "]"}], "&"}], ",", "LV"}], "]"}]}], 
        ";", " ", 
        RowBox[{"(*", 
         RowBox[{
         "Osservare", " ", "la", " ", "differenza", " ", "tra", " ", "il", 
          " ", "caso", " ", "dei", " ", "propagatori", " ", "e", " ", "il", 
          " ", "caso", " ", "dei", " ", "vertici"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"LV", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"sostituiscicaricaloop", "[", 
             RowBox[{"#", ",", "loop"}], "]"}], "&"}], ",", "LV"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "LV", "]"}], ";", 
          RowBox[{"Print", "[", "LP", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"A0", " ", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"LLE", ",", "LP", ",", "LV"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"loop", "==", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", 
             RowBox[{"-", "1"}]}], "}"}]}], ",", 
          RowBox[{"A0", "=", 
           RowBox[{
            RowBox[{"A0", "/.", 
             RowBox[{
              RowBox[{"q", "[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], "->", 
              RowBox[{"s", "[", 
               RowBox[{
                RowBox[{"-", "1"}], ",", 
                RowBox[{"-", "1"}]}], "]"}]}]}], "/.", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1"}]}], "]"}], "->", 
             RowBox[{"k", "[", 
              RowBox[{
               RowBox[{"-", "1"}], ",", 
               RowBox[{"-", "1"}]}], "]"}]}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "REGOLE", " ", "DI", " ", "SOSTITUZIONE", " ", "SULLE", " ", 
          "CARICHE"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Si", " ", "definiscono", " ", "delle", " ", "regole", " ", "di", 
          " ", "sostituzione", " ", "per", " ", "le", " ", "varie", " ", 
          "entrate", " ", "nel", " ", "vertice"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"sostitCariche", " ", "=", " ", 
         RowBox[{"generaequazionicaricheloop", "[", "diagramma", "]"}]}], ";",
         "   ", 
        RowBox[{"(*", 
         RowBox[{"Equazione", " ", "delle", " ", "cariche"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"datiEntranti", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Rule", "[", 
            RowBox[{
             RowBox[{"q", "[", "i", "]"}], ",", 
             RowBox[{"carichedate", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "entranti"}], "}"}]}], "]"}]}], ";", 
        "        ", 
        RowBox[{"(*", 
         RowBox[{
         "Le", " ", "cariche", " ", "di", " ", "gambe", " ", "entranti", " ", 
          "sono", " ", "sostituite", " ", "con", " ", "il", " ", "loro", " ", 
          "valore"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"datiUscenti", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Rule", "[", 
            RowBox[{
             RowBox[{"q", "[", "i", "]"}], ",", 
             RowBox[{"-", 
              RowBox[{"carichedate", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}]}], " ", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"entranti", "+", "1"}], ",", "npt"}], "}"}]}], "]"}]}], 
        ";", " ", 
        RowBox[{"(*", 
         RowBox[{
         "Le", " ", "cariche", " ", "di", " ", "gambe", " ", "uscenti", " ", 
          "sono", " ", "sostituite", " ", "con", " ", "il", " ", "loro", " ", 
          "valore", " ", "cambiato", " ", "di", " ", "segno"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"dati", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"datiEntranti", ",", "datiUscenti"}], "]"}]}], ";", "  ", 
        "\[IndentingNewLine]", 
        RowBox[{"A1", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"A0", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"q", "[", 
               RowBox[{
                RowBox[{"k_", "/;", 
                 RowBox[{"k", ">", "0"}]}], ",", "t_"}], "]"}], "\[Rule]", 
              RowBox[{"q", "[", "k", "]"}]}], "}"}]}], "/.", "dati"}], "/.", 
          "sostitCariche"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ampiezza1", "=", 
         RowBox[{"generaampiezzaloopconcarica", "[", 
          RowBox[{"diagramma", ",", 
           RowBox[{"+", "1"}], ",", "loop", ",", "A1", ",", "sostitCariche"}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ampiezza2", "=", 
         RowBox[{"generaampiezzaloopconcarica", "[", 
          RowBox[{
          "diagramma", ",", "0", ",", "loop", ",", "A1", ",", 
           "sostitCariche"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ampiezza3", "=", 
         RowBox[{"generaampiezzaloopconcarica", "[", 
          RowBox[{"diagramma", ",", 
           RowBox[{"-", "1"}], ",", "loop", ",", "A1", ",", "sostitCariche"}],
           "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"FindCycle", "[", 
              RowBox[{"grafaungrafo", "[", "grafo", "]"}], "]"}], "]"}], 
            "]"}], "<", "3"}], ",", 
          RowBox[{"fattoredisimmetria", "=", 
           RowBox[{"1", "/", "2"}]}], ",", 
          RowBox[{"fattoredisimmetria", "=", "1"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"risultato", "=", 
         RowBox[{
          RowBox[{"ExpandAll", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ampiezza1", "+", "ampiezza2", "+", "ampiezza3"}], ")"}],
             "*", "fattoredisimmetria"}], "]"}], "/.", 
          RowBox[{
           RowBox[{"SP", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"-", "1"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"-", "1"}], "}"}]}], "]"}], "->", "4"}]}]}], ";", 
        "\[IndentingNewLine]", "risultato"}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"generaampiezzaloopconcarica", "[", 
      RowBox[{
      "diagramma_", ",", "caricaloop_", ",", "loop_", ",", "ampiezzagrezza_", 
       ",", "equazioniperlecariche_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "temp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"grafo", "=", 
         RowBox[{"diagramma", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"entranti", "=", 
         RowBox[{"diagramma", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"carichedate", "=", 
         RowBox[{"diagramma", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
        RowBox[{"indici", "=", 
         RowBox[{"Flatten", "[", "grafo", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"npt", "=", 
         RowBox[{"Max", "[", "indici", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"nvert", "=", 
         RowBox[{"Min", "[", "indici", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"sostituzioniCariche", "=", 
         RowBox[{"equazioniperlecariche", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"s", ",", "loop"}], "]"}], "->", "caricaloop"}], 
           "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"A2", "=", 
         RowBox[{"ampiezzagrezza", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"s", ",", "loop"}], "]"}], "->", "caricaloop"}], 
           "}"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"CONSISTENZA", " ", "CARICHE"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Acc", "=", 
         RowBox[{"Cases", "[", " ", 
          RowBox[{"sostituzioniCariche", ",", 
           RowBox[{
            RowBox[{"Rule", "[", 
             RowBox[{
              RowBox[{"q", "[", 
               RowBox[{"_", ",", "_"}], "]"}], ",", "n_"}], "]"}], "\[Rule]", 
            "n"}], ",", "3"}], "]"}]}], ";", "   ", 
        RowBox[{"(*", 
         RowBox[{
         "Crea", " ", "la", " ", "lista", " ", "dei", " ", "risultati", " ", 
          "cercando", " ", "al", " ", "livello", " ", "3", " ", "quel", " ", 
          "pattern", " ", "ed", " ", "estraendovi", " ", "la", " ", 
          "variabile", " ", "s"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"Acc", ",", 
             RowBox[{"i_", "/;", 
              RowBox[{
               RowBox[{"i", "\[NotEqual]", "0"}], "&&", 
               RowBox[{"i", "\[NotEqual]", "1"}], "&&", 
               RowBox[{"i", "\[NotEqual]", 
                RowBox[{"-", "1"}]}]}]}]}], "]"}], "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", "                                ", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "Se", " ", "la", " ", "lista", " ", "contiene", " ", "valori", 
             " ", "che", " ", "non", " ", "sono", " ", "1"}], ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"0", " ", "non", " ", "va", " ", "bene"}], ",", " ", 
            RowBox[{"farlo", " ", "con", " ", "valore", " ", 
             RowBox[{"assoluto", "?"}]}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"A2", "=", 
           RowBox[{"{", "0", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"A2", "=", "A2"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"VERIFICA", " ", "SUI", " ", "VERTICI"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"ListaDelleCaricheSuOgniVertice", " ", "=", " ", 
         RowBox[{"Cases", "[", 
          RowBox[{"A2", ",", 
           RowBox[{
            RowBox[{"V2", "[", 
             RowBox[{"a__", ",", "b__", ",", "c__"}], "]"}], "->", "b"}], ",",
            "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ListaDelleSommeDiValoriAssolutiSuOgniVertice", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"Plus", ",", 
              RowBox[{"Abs", "[", "#", "]"}]}], "]"}], "&"}], ",", 
           "ListaDelleCaricheSuOgniVertice"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"ListaDelleSommeDiValoriAssolutiSuOgniVertice", ",", 
             RowBox[{"i_", "/;", 
              RowBox[{"i", "\[NotEqual]", "2"}]}]}], "]"}], "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"A3", "=", 
           RowBox[{"{", "0", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"A3", "=", "A2"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "REGOLE", " ", "DI", " ", "SOSTITUZIONE", " ", "PER", " ", "I", " ", 
          "MOMENTI"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"globale", ":=", 
         RowBox[{"Rule", "[", 
          RowBox[{
           RowBox[{"p", "[", "npt", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"p", "[", "l", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", 
                RowBox[{"npt", "-", "1"}]}], "}"}]}], "]"}]}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"A3", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"A3", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{
                RowBox[{"k_", "/;", 
                 RowBox[{"k", ">", "0"}]}], ",", "t_"}], "]"}], "\[Rule]", 
              RowBox[{"p", "[", "k", "]"}]}], "}"}]}], "/.", "globale"}], "/.", 
          RowBox[{"generaequazioniloop", "[", "grafo", "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"SOSTITUZIONE", " ", "DI", " ", "PROPAGATORI"}], ",", " ", 
          RowBox[{"VERTICI", " ", "E", " ", "GAMBE", " ", "ESTERNE"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"A3", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"A3", "/.", 
            RowBox[{"{", 
             RowBox[{"Prop2", "->", "Prop3"}], "}"}]}], "/.", 
           RowBox[{"{", 
            RowBox[{"V2", "->", "V3"}], "}"}]}], "/.", 
          RowBox[{"{", 
           RowBox[{"Est2", "->", "Est3"}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"A3", "=", 
         RowBox[{"Flatten", "[", "A3", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"risultato", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"Times", ",", "A3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "risultato"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ampiezzatotaleloop", "[", 
      RowBox[{"entranti_", ",", "a__"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "temp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "ALCUNE", " ", "REGOLE", " ", "ALGEBRICHE", " ", "SULLE", " ", 
         "GAMBE", " ", "ESTERNE"}], "*)"}], "\[IndentingNewLine]", " ", 
       RowBox[{
        RowBox[{"carichedate", "=", "a"}], ";", "\[IndentingNewLine]", 
        RowBox[{"npt", "=", 
         RowBox[{"Length", "[", "carichedate", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SP", "[", 
          RowBox[{
           RowBox[{"p", "[", "i_", "]"}], ",", 
           RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{"Mel", "^", "2"}], " ", "/;", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"carichedate", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], "==", "1"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SP", "[", 
          RowBox[{
           RowBox[{"p", "[", "i_", "]"}], ",", 
           RowBox[{"p", "[", "i_", "]"}]}], "]"}], ":=", 
         RowBox[{"0", "/;", 
          RowBox[{
           RowBox[{"carichedate", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "==", "0"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SP", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"p", "[", "i", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"npt", "-", "1"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"p", "[", "i", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"npt", "-", "1"}]}], "}"}]}], "]"}]}], "]"}], ":=", 
         RowBox[{"carichedate", "[", 
          RowBox[{"[", "npt", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"grafi", "=", 
         RowBox[{"generagrafi", "[", 
          RowBox[{"Length", "[", "a", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"grafiloop", "=", 
         RowBox[{"generagrafiloop", "[", 
          RowBox[{"Length", "[", "a", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"listadiagrammi", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"diagramma", "[", 
             RowBox[{"#", ",", "entranti", ",", "a"}], "]"}], "&"}], ",", 
           "grafi"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"listadiagrammiloop", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"diagramma", "[", 
             RowBox[{"#", ",", "entranti", ",", "a"}], "]"}], "&"}], ",", 
           "grafiloop"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"risultato", "=", 
         RowBox[{"ExpandAll", "[", 
          RowBox[{"Apply", "[", 
           RowBox[{"Plus", ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Map", "[", 
               RowBox[{"generaampiezza", ",", "listadiagrammi"}], "]"}], ",", 
              RowBox[{"Map", "[", 
               RowBox[{"generaampiezzaloop", ",", "listadiagrammiloop"}], 
               "]"}]}], "]"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "risultato"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.8661783965130377`*^9, 3.866178406683745*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"09cf89df-5912-4a70-a912-3a4dec113efd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Graph", "[", 
       RowBox[{"#", ",", 
        RowBox[{"VertexLabels", "\[Rule]", "\"\<Name\>\""}]}], "]"}], "&"}], 
     ",", 
     RowBox[{"Map", "[", 
      RowBox[{"grafaungrafo", ",", 
       RowBox[{"generagrafiloop", "[", "3", "]"}]}], "]"}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"generaampiezzaloop", "[", 
       RowBox[{"diagramma", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"generagrafiloop", "[", "3", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "1", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}], "\[IndentingNewLine]",
       "amp"}], "=", 
     RowBox[{"ampiezzatotaleloop", "[", 
      RowBox[{"3", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}], ",", "0", ",", "0", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Length", "[", "amp", "]"}]}], "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.866178412574131*^9, 
  3.8661784178628025`*^9}},ExpressionUUID->"861f08fc-0738-475f-9666-\
13a4377294b3"]
},
WindowSize->{1428., 741.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{595.275590551181, 841.8897637795276}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (February 4, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ffa7586d-6815-4ea8-9801-486e6020a179"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 76745, 1836, 4500, "Input",ExpressionUUID->"9b9ca76a-6383-4659-b601-d242e76fda7f"],
Cell[77306, 1858, 50271, 1209, 3948, "Input",ExpressionUUID->"09cf89df-5912-4a70-a912-3a4dec113efd"],
Cell[127580, 3069, 1423, 41, 124, "Input",ExpressionUUID->"861f08fc-0738-475f-9666-13a4377294b3"]
}
]
*)

